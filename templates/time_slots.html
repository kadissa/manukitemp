{% extends 'base.html' %}
{% load extend_filters %}
{% load crispy_forms_tags %}
{% load crispy_forms_field %}
{% block content %}

  <div class="btn"></div>
  {% include 'includes/header.html' %}
  <br>
  <div class="form-group text-center">
    <span class="border-bottom text-bg-info 
        text-white rounded-1 pt-2 pb-2"
    ><span>Свободные слоты на {{ date }}</span>
    </span>
  </div>
  <div class="container text-center" id="time-slots">


    <div class="row row-cols-md-6  justify-content-center">
      {% for key, time_slot in available_slots.items %}
        <div class="col">
          {% with date|date:'w' as week_day %}

          
            {% if time_slot not in times %}

              {% if week_day|str_to_int > 5 %}
                <label for="{{ time_slot }}" class="bg-opacity-50 
              bg-success mt-3 
            border-1 
            border rounded"> 
                  2500руб.
                </label>
                {% elif week_day|str_to_int == 5 and key|str_to_int > 17%}
                <label for="{{ time_slot }}" class="bg-opacity-50 
              bg-success mt-3 
            border-1 
            border rounded"> 
                  2500руб.
                </label>
              {% else %}
{#                <input type="text" name="price" size="5" value="2000р" #}
{#                       class="bg-opacity-50 bg-success text-center rounded mt-3"#}
{#                        readonly>#}
                <label for="{{ time_slot }}" class="bg-opacity-50 
              bg-success mt-3 
            border-1 
            border rounded">
                  2000руб.
                </label>
              {% endif %}
              <input type="text" name="time" size="8" id="{{ time_slot }}"
                     value="{{ time_slot }}"
                     class="mt-0 btn btn-warning bg-white"
                     hx-post="{% url 'time' date user_id %}"
                     hx-trigger="click"
                     hx-push-url="true"
                     HX-Refresh="true"
                     readonly
              >
            {% else %}

              <input type="text" name="time" size="8"
                     value="{{ time_slot }}"
                     class="mt-3 btn btn-warning bg-white"
                     data-hx-post="{% url 'time' date user_id %}"
                     hx-confirm="Are you sure you want to delete this event?"
                     hx-trigger="click"
                     hx-push-url="true"
                     hx-swap="none"
                     HX-Refresh="true"
                     readonly
                     disabled
              >
            {% endif %}
          {% endwith %}

        </div>
      {% endfor %}


    </div>
    <a href="{% url 'user' %}">
      <button class="btn mt-3 bg-white border-info" style="float: 
        left">Выбрать другой день или время
      </button>
    </a>
    {% if times %}
      {% if times|length_is:1 %}
        <button class="btn mt-3 btn-danger" style="float: right" type="submit">
          Выберите более одного слота
        </button>
      {% else %}
        <a href="{% url 'create_appointment' day user_id %}">
          <button class="btn mt-3 btn-success" style="float: right"
                  type="submit">
            Заказать
          </button>
        </a>
      {% endif %}
    {% endif %}
  </div>


{% endblock %}